<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Emergency & Reminders</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
button { margin: 5px; }
#status, #weather, #country { margin: 10px 0; }
</style>
</head>
<body>

<h1 id="title">Экстренные службы и напоминания</h1>

<label id="status_label">Статус:</label>
<span id="status">Не начато</span><br>

<label id="country_label">Ваша страна:</label>
<span id="country">Не определено</span><br>

<label id="weather_label">Погода:</label>
<span id="weather">Не определено</span><br>

<button id="startBtn">Начать</button>
<select id="langSelect">
<option value="ru">Русский</option>
<option value="en">English</option>
<option value="uk">Українська</option>
<option value="hu">Magyar</option>
<option value="fr">Français</option>
</select>

<div id="reminders"></div>

<script>
let lang = 'ru';
const apiKey = 'YOUR_OPENWEATHERMAP_API_KEY'; // Вставьте ваш API ключ
const i18n = {
    ru: { title:"Экстренные службы и напоминания", start:"Начать", status_not_started:"Не начато",
          locating:"Определяем местоположение...", location_failed:"Не удалось определить местоположение.",
          your_country: c=>`Ваша страна: ${c}`, weather_label:"Погода:", reminders_label:"Напоминания:",
          now_weather_tts:(t,d)=>`Сейчас ${t} градусов, ${d}`, temp_weather_tts:(t,d)=>`Температура сейчас ${t} градусов, ${d}`,
          lang_set: lc=>`Язык установлен: ${lc}`, country_set: c=>`Страна установлена: ${c}`, weather_text:(t,d)=>`Погода: ${t}°C, ${d}`
    },
    en: { title:"Emergency Services & Reminders", start:"Start", status_not_started:"Not started",
          locating:"Locating...", location_failed:"Failed to get location.",
          your_country: c=>`Your country: ${c}`, weather_label:"Weather:", reminders_label:"Reminders:",
          now_weather_tts:(t,d)=>`Currently ${t} degrees, ${d}`, temp_weather_tts:(t,d)=>`Current temperature ${t} degrees, ${d}`,
          lang_set: lc=>`Language set: ${lc}`, country_set: c=>`Country set: ${c}`, weather_text:(t,d)=>`Weather: ${t}°C, ${d}`
    },
    uk: { title:"Надзвичайні служби та нагадування", start:"Почати", status_not_started:"Не розпочато",
          locating:"Визначення місцезнаходження...", location_failed:"Не вдалося визначити місцезнаходження.",
          your_country: c=>`Ваша країна: ${c}`, weather_label:"Погода:", reminders_label:"Нагадування:",
          now_weather_tts:(t,d)=>`Зараз ${t} градусів, ${d}`, temp_weather_tts:(t,d)=>`Температура зараз ${t} градусів, ${d}`,
          lang_set: lc=>`Мову встановлено: ${lc}`, country_set: c=>`Країна встановлена: ${c}`, weather_text:(t,d)=>`Погода: ${t}°C, ${d}`
    },
    hu: { title:"Vészhelyzeti szolgáltatások és emlékeztetők", start:"Indítás", status_not_started:"Nem indult el",
          locating:"Helymeghatározás...", location_failed:"Nem sikerült meghatározni a helyet.",
          your_country: c=>`Országod: ${c}`, weather_label:"Időjárás:", reminders_label:"Emlékeztetők:",
          now_weather_tts:(t,d)=>`Jelenleg ${t} fok, ${d}`, temp_weather_tts:(t,d)=>`Jelenlegi hőmérséklet ${t} fok, ${d}`,
          lang_set: lc=>`Nyelv beállítva: ${lc}`, country_set: c=>`Ország beállítva: ${c}`, weather_text:(t,d)=>`Időjárás: ${t}°C, ${d}`
    },
    fr: { title:"Services d'urgence et rappels", start:"Démarrer", status_not_started:"Pas commencé",
          locating:"Localisation...", location_failed:"Impossible d'obtenir la localisation.",
          your_country: c=>`Votre pays: ${c}`, weather_label:"Météo:", reminders_label:"Rappels:",
          now_weather_tts:(t,d)=>`Actuellement ${t} degrés, ${d}`, temp_weather_tts:(t,d)=>`Température actuelle ${t} degrés, ${d}`,
          lang_set: lc=>`Langue définie: ${lc}`, country_set: c=>`Pays défini: ${c}`, weather_text:(t,d)=>`Météo: ${t}°C, ${d}`
    }
};

const startBtn = document.getElementById('startBtn');
const statusSpan = document.getElementById('status');
const countrySpan = document.getElementById('country');
const weatherSpan = document.getElementById('weather');
const langSelect = document.getElementById('langSelect');

function speak(text) {
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = lang;
    speechSynthesis.speak(utter);
}

function setLanguage(l) {
    lang = l;
    document.getElementById('title').innerText = i18n[lang].title;
    startBtn.innerText = i18n[lang].start;
    statusSpan.innerText = i18n[lang].status_not_started;
    countrySpan.innerText = i18n[lang].your_country("...");
    weatherSpan.innerText = i18n[lang].weather_text("-", "-");
    speak(i18n[lang].lang_set(lang));
}

langSelect.addEventListener('change', ()=>setLanguage(langSelect.value));
setLanguage(lang);

async function fetchWeather(lat, lon) {
    try {
        const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=${lang}&appid=${apiKey}`);
        const data = await res.json();
        const desc = data.weather[0].description;
        const temp = data.main.temp;
        weatherSpan.innerText = i18n[lang].weather_text(temp, desc);
        speak(i18n[lang].now_weather_tts(temp, desc));
    } catch (err) {
        weatherSpan.innerText = i18n[lang].location_failed;
    }
}

async function detectCountry(lat, lon) {
    try {
        const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
        const data = await res.json();
        const country = data.address.country || "Unknown";
        countrySpan.innerText = i18n[lang].your_country(country);
        speak(i18n[lang].country_set(country));
    } catch (err) {
        countrySpan.innerText = i18n[lang].location_failed;
    }
}

startBtn.addEventListener('click', ()=>{
    statusSpan.innerText = i18n[lang].locating;
    navigator.geolocation.getCurrentPosition(pos=>{
        const {latitude, longitude} = pos.coords;
        statusSpan.innerText = "OK";
        detectCountry(latitude, longitude);
        fetchWeather(latitude, longitude);
    }, err=>{
        statusSpan.innerText = i18n[lang].location_failed;
    });
});
</script>
</body>
</html>
