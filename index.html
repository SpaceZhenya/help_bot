ZhenyaOd, [24.08.2025 18:23]
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Экстренные службы и напоминания</title>
<style>
    body { font-family: sans-serif; background: #f0f0f0; padding: 20px; }
    .panel { background: #fff; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    button { margin: 5px 0; padding: 10px 15px; }
</style>
</head>
<body>
<h1>Экстренные службы и напоминания</h1>

<div class="panel">
    <label>Выберите язык (ru, en, uk, hu, fr): </label>
    <input type="text" id="langInput" value="ru">
    <button onclick="startApp()">Начать</button>
</div>

<div class="panel" id="statusPanel">
    <strong>Статус:</strong> <span id="status">Не начато</span>
</div>

<div class="panel" id="weatherPanel">
    <strong>Погода:</strong> <span id="weather">---</span>
</div>

<div class="panel" id="reminderPanel">
    <strong>Напоминания:</strong> <span id="reminder">---</span>
</div>

<div class="panel" id="emergencyPanel">
    <strong>Экстренные действия:</strong><br>
    <button onclick="emergencySoundDetection(currentCountry, langCode)">Проверить звук</button>
    <button onclick="emergencyCall(currentCountry, 'полиция', langCode)">Полиция</button>
    <button onclick="emergencyCall(currentCountry, 'пожарная', langCode)">Пожарная</button>
    <button onclick="emergencyCall(currentCountry, 'скорая', langCode)">Скорая</button>
</div>

<script>
// ===== Словарь экстренных номеров =====
const emergencyNumbers = {
    "Россия": { полиция: "+78001005050", пожарная: "+101", скорая: "+103", спасатели: "+112" },
    "США": { полиция: "+911", пожарная: "+911", скорая: "+911", спасатели: "+911" },
    "Украина": { полиция: "+102", пожарная: "+101", скорая: "+103", спасатели: "+112" },
    "Венгрия": { полиция: "+112", пожарная: "+105", скорая: "+104", спасатели: "+112" },
    "Франция": { полиция: "+17", пожарная: "+18", скорая: "+15", спасатели: "+112" }
};

let langCode = "ru";
let currentCountry = "Неизвестно";

// ===== Функция озвучки =====
function speak(text, lang) {
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = lang;
    speechSynthesis.speak(utter);
}

// ===== Получение геопозиции =====
async function getLocation() {
    return new Promise((resolve) => {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos => {
                resolve({lat: pos.coords.latitude, lon: pos.coords.longitude});
            }, err => resolve(null));
        } else resolve(null);
    });
}

// ===== Получение погоды через wttr.in =====
async function getWeather(lat, lon) {
    try {
        const url = https://wttr.in/${lat},${lon}?format=j1;
        const res = await fetch(url);
        const data = await res.json();
        const current = data.current_condition[0];
        return { temp: current.temp_C, desc: current.weatherDesc[0].value };
    } catch(e) {
        console.log("Ошибка получения погоды:", e);
        return null;
    }
}

// ===== Определение страны по координатам через геокодинг =====
async function getCountry(lat, lon) {
    try {
        const res = await fetch(https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon});
        const data = await res.json();
        return data.address.country || "Неизвестно";
    } catch(e) {
        return "Неизвестно";
    }
}

// ===== Экстренные события =====
function emergencySoundDetection(country, lang) {
    const sound = prompt("Какой звук вы услышали? (крик, стон, плач, вор, пожар или 'нет')")?.toLowerCase();

    if (["крик","стон","плач"].includes(sound)) {
        const help = prompt("Вы чувствуете боль или нужна помощь? (да/нет)")?.toLowerCase();
        if (help === "да") speak("Рекомендую обратиться к врачу.", lang);
        else speak("Будьте осторожны.", lang);

ZhenyaOd, [24.08.2025 18:23]
} else if (sound === "вор") {
        speak(Звоню в полицию: ${emergencyNumbers[country].полиция}, lang);
    } else if (sound === "пожар") {
        speak(Звоню в пожарную службу: ${emergencyNumbers[country].пожарная}, lang);
    } else {
        speak("Звук не распознан или нет опасности.", lang);
    }
}

// ===== Экстренный звонок =====
function emergencyCall(country, service, lang) {
    if (emergencyNumbers[country] && emergencyNumbers[country][service]) {
        speak(Звоню в ${service}: ${emergencyNumbers[country][service]}, lang);
    } else {
        speak(Служба ${service} недоступна в вашей стране, lang);
    }
}

// ===== Установка напоминания =====
function setReminder(reminderTime, task, lat, lon, lang) {
    const interval = setInterval(async () => {
        const now = new Date();
        const h = String(now.getHours()).padStart(2,'0');
        const m = String(now.getMinutes()).padStart(2,'0');
        const timeStr = ${h}:${m};
        if (timeStr === reminderTime) {
            const weather = await getWeather(lat, lon);
            let msg = Напоминаю: ${task}.;
            if (weather) msg +=  Температура ${weather.temp}°C, погода: ${weather.desc}.;
            speak(msg, lang);
            document.getElementById("reminder").innerText = msg;
            clearInterval(interval);
        }
    }, 30000); // каждые 30 секунд
}

// ===== Основная функция =====
async function startApp() {
    langCode = document.getElementById("langInput").value || "ru";
    document.getElementById("status").innerText = "Определяем местоположение...";
    const loc = await getLocation();
    if (!loc) {
        speak("Не удалось определить местоположение.", langCode);
        return;
    }

    currentCountry = await getCountry(loc.lat, loc.lon);
    document.getElementById("status").innerText = Ваша страна: ${currentCountry};

    const weather = await getWeather(loc.lat, loc.lon);
    if (weather) {
        document.getElementById("weather").innerText = Погода: ${weather.temp}°C, ${weather.desc};
        speak(Сейчас температура ${weather.temp} градусов, ${weather.desc}, langCode);
    }

    // Пример напоминания на 15:00
    setReminder("15:00", "гулять на улице", loc.lat, loc.lon, langCode);
}
</script>
</body>
</html>
